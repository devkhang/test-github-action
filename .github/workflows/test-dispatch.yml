name: Test Workflow Dispatch with UI Input

# KÃ­ch hoáº¡t thá»§ cÃ´ng qua UI (workflow_dispatch) hoáº·c tá»± Ä‘á»™ng khi push
on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'MÃ´i trÆ°á»ng deploy (staging/production)'
        required: true
        default: 'staging'
        type: choice
        options:
          - staging
          - production
      message:
        description: 'Tin nháº¯n tÃ¹y chá»‰nh (tÃ¹y chá»n)'
        required: false
        type: string
        default: 'Hello from VN!'
  push:
    branches: [main]

jobs:
  test-dispatch:
    name: Run Test with UI Inputs
    runs-on: ubuntu-latest

    steps:
      # BÆ°á»›c 1: Láº¥y code repo (báº¯t buá»™c)
      - name: Checkout Repository
        uses: actions/checkout@v4

      # BÆ°á»›c 2: Hiá»ƒn thá»‹ inputs tá»« UI
      - name: Display UI Inputs
        run: |
          echo "Environment: ${{ github.event.inputs.environment || 'staging' }}"
          echo "Message: ${{ github.event.inputs.message || 'Hello from VN!' }}"

      # BÆ°á»›c 3: MÃ´ phá»ng deploy dá»±a trÃªn input
      - name: Simulate Deploy
        run: |
          ENV="${{ github.event.inputs.environment || 'staging' }}"
          MSG="${{ github.event.inputs.message || 'Hello from VN!' }}"
          if [ "$ENV" = "production" ]; then
            echo "ðŸš€ Deploying to PRODUCTION with message: $MSG"
          else
            echo "ðŸ”„ Deploying to STAGING with message: $MSG"
          fi

      # BÆ°á»›c 4: Set output Ä‘á»ƒ sá»­ dá»¥ng sau
      - name: Set Final Output
        id: output
        run: |
          ENV="${{ github.event.inputs.environment || 'staging' }}"
          echo "deployment_env=$ENV" >> $GITHUB_OUTPUT
          echo "custom_message=${{ github.event.inputs.message || 'Hello from VN!' }}" >> $GITHUB_OUTPUT

      # BÆ°á»›c 5: Hiá»ƒn thá»‹ output cuá»‘i
      - name: Show Final Results
        run: |
          echo "Deployment Environment: ${{ steps.output.outputs.deployment_env }}"
          echo "Custom Message: ${{ steps.output.outputs.custom_message }}"